{"ast":null,"code":"const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\nexport const login = async (email, password) => {\n  const res = await fetch(`${API_BASE}/api/auth/login`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      email,\n      password\n    })\n  });\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.error || 'Login failed');\n  // Save token to localStorage for later requests (optional)\n  if (data.token) localStorage.setItem('token', data.token);\n  // persist basic user info for the frontend\n  try {\n    localStorage.setItem('user', JSON.stringify({\n      id: data.id,\n      email: data.email,\n      role: data.role\n    }));\n  } catch (e) {}\n  return data; // { id, email, role, token }\n};\nexport const logout = async () => {\n  localStorage.removeItem('token');\n};\nexport const getCurrentUser = () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) return null;\n    // We don't decode here; callers should use stored user data returned from login/signup\n    return {\n      token\n    };\n  } catch (e) {\n    return null;\n  }\n};\nexport const signUp = async (email, password, role = 'siswa') => {\n  const res = await fetch(`${API_BASE}/api/auth/signup`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      email,\n      password,\n      role\n    })\n  });\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.error || 'Sign up failed');\n  if (data.token) localStorage.setItem('token', data.token);\n  try {\n    localStorage.setItem('user', JSON.stringify({\n      id: data.id,\n      email: data.email,\n      role: data.role\n    }));\n  } catch (e) {}\n  return data; // { id, email, role, token }\n};","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_URL","login","email","password","res","fetch","method","headers","body","JSON","stringify","data","json","ok","Error","error","token","localStorage","setItem","id","role","e","logout","removeItem","getCurrentUser","getItem","signUp"],"sources":["C:/Users/Administrator/lms-app/src/utils/auth.js"],"sourcesContent":["const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\r\n\r\nexport const login = async (email, password) => {\r\n  const res = await fetch(`${API_BASE}/api/auth/login`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ email, password }),\r\n  });\r\n  const data = await res.json();\r\n  if (!res.ok) throw new Error(data.error || 'Login failed');\r\n  // Save token to localStorage for later requests (optional)\r\n  if (data.token) localStorage.setItem('token', data.token);\r\n  // persist basic user info for the frontend\r\n  try { localStorage.setItem('user', JSON.stringify({ id: data.id, email: data.email, role: data.role })); } catch (e) {}\r\n  return data; // { id, email, role, token }\r\n};\r\n\r\nexport const logout = async () => {\r\n  localStorage.removeItem('token');\r\n};\r\n\r\nexport const getCurrentUser = () => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return null;\r\n    // We don't decode here; callers should use stored user data returned from login/signup\r\n    return { token };\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const signUp = async (email, password, role = 'siswa') => {\r\n  const res = await fetch(`${API_BASE}/api/auth/signup`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ email, password, role }),\r\n  });\r\n  const data = await res.json();\r\n  if (!res.ok) throw new Error(data.error || 'Sign up failed');\r\n  if (data.token) localStorage.setItem('token', data.token);\r\n  try { localStorage.setItem('user', JSON.stringify({ id: data.id, email: data.email, role: data.role })); } catch (e) {}\r\n  return data; // { id, email, role, token }\r\n};\r\n     "],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,uBAAuB;AAEzE,OAAO,MAAMC,KAAK,GAAG,MAAAA,CAAOC,KAAK,EAAEC,QAAQ,KAAK;EAC9C,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGR,QAAQ,iBAAiB,EAAE;IACpDS,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAER,KAAK;MAAEC;IAAS,CAAC;EAC1C,CAAC,CAAC;EACF,MAAMQ,IAAI,GAAG,MAAMP,GAAG,CAACQ,IAAI,CAAC,CAAC;EAC7B,IAAI,CAACR,GAAG,CAACS,EAAE,EAAE,MAAM,IAAIC,KAAK,CAACH,IAAI,CAACI,KAAK,IAAI,cAAc,CAAC;EAC1D;EACA,IAAIJ,IAAI,CAACK,KAAK,EAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEP,IAAI,CAACK,KAAK,CAAC;EACzD;EACA,IAAI;IAAEC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAET,IAAI,CAACC,SAAS,CAAC;MAAES,EAAE,EAAER,IAAI,CAACQ,EAAE;MAAEjB,KAAK,EAAES,IAAI,CAACT,KAAK;MAAEkB,IAAI,EAAET,IAAI,CAACS;IAAK,CAAC,CAAC,CAAC;EAAE,CAAC,CAAC,OAAOC,CAAC,EAAE,CAAC;EACtH,OAAOV,IAAI,CAAC,CAAC;AACf,CAAC;AAED,OAAO,MAAMW,MAAM,GAAG,MAAAA,CAAA,KAAY;EAChCL,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC;AAClC,CAAC;AAED,OAAO,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAClC,IAAI;IACF,MAAMR,KAAK,GAAGC,YAAY,CAACQ,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAI,CAACT,KAAK,EAAE,OAAO,IAAI;IACvB;IACA,OAAO;MAAEA;IAAM,CAAC;EAClB,CAAC,CAAC,OAAOK,CAAC,EAAE;IACV,OAAO,IAAI;EACb;AACF,CAAC;AAED,OAAO,MAAMK,MAAM,GAAG,MAAAA,CAAOxB,KAAK,EAAEC,QAAQ,EAAEiB,IAAI,GAAG,OAAO,KAAK;EAC/D,MAAMhB,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGR,QAAQ,kBAAkB,EAAE;IACrDS,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAER,KAAK;MAAEC,QAAQ;MAAEiB;IAAK,CAAC;EAChD,CAAC,CAAC;EACF,MAAMT,IAAI,GAAG,MAAMP,GAAG,CAACQ,IAAI,CAAC,CAAC;EAC7B,IAAI,CAACR,GAAG,CAACS,EAAE,EAAE,MAAM,IAAIC,KAAK,CAACH,IAAI,CAACI,KAAK,IAAI,gBAAgB,CAAC;EAC5D,IAAIJ,IAAI,CAACK,KAAK,EAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEP,IAAI,CAACK,KAAK,CAAC;EACzD,IAAI;IAAEC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAET,IAAI,CAACC,SAAS,CAAC;MAAES,EAAE,EAAER,IAAI,CAACQ,EAAE;MAAEjB,KAAK,EAAES,IAAI,CAACT,KAAK;MAAEkB,IAAI,EAAET,IAAI,CAACS;IAAK,CAAC,CAAC,CAAC;EAAE,CAAC,CAAC,OAAOC,CAAC,EAAE,CAAC;EACtH,OAAOV,IAAI,CAAC,CAAC;AACf,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}